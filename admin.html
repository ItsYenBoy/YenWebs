<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>College Summaries Portal</title>

  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

  <link rel="stylesheet" href="style.css">
</head>

<body>
  <div class="container">
    <header>
      <div class="logo"><i class="fa-solid fa-graduation-cap"></i> UniNotes Admin</div>
    </header>

    <div class="card">
      <h2>Admin Control Panel</h2>

      <div class="auth-wrap" style="margin-top: 20px;">
        <div class="auth-box card" style="flex: 1; min-width: 300px;">
          <input id="studentName" type="text" placeholder="Student Name" />
          <input id="studentCode" type="text" placeholder="Student Code" />
          <label><input type="checkbox" id="isAdminCheckbox" /> Is Admin</label>
          <button id="addStudentBtn" class="btn primary" style="width: 100%;">Add Student</button>
        </div>
      </div>

      <h3 style="margin-top: 20px;">Allowed Students</h3>
      <div class="table-container" style="margin-top: 10px;">
        <table id="studentsTable">
          <thead>
            <tr>
              <th>Name</th>
              <th>Code</th>
              <th>Admin</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </div>
  </div>

  <script>
    const firebaseConfig = {
       apiKey: "AIzaSyBC8_X5D_7poZiEj7C6eLq9y1GDBN0_Afo",
  authDomain: "yenwebs.firebaseapp.com",
  projectId: "yenwebs",
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    const addStudentBtn = document.getElementById("addStudentBtn");
    const studentsTableBody = document.querySelector("#studentsTable tbody");

    async function loadStudents() {
      studentsTableBody.innerHTML = "";
      const snapshot = await db.collection("allowedCodes").get();
      snapshot.forEach((doc) => {
        const data = doc.data();
        const row = document.createElement("tr");
        row.innerHTML = `
          <td>${data.name}</td>
          <td>${data.code}</td>
          <td>${data.admin ? "Yes" : "No"}</td>
          <td><button class="btn" onclick="deleteStudent('${doc.id}')">Delete</button></td>
        `;
        studentsTableBody.appendChild(row);
      });
    }

    addStudentBtn.onclick = async () => {
      const name = document.getElementById("studentName").value.trim();
      const code = document.getElementById("studentCode").value.trim();
      const isAdmin = document.getElementById("isAdminCheckbox").checked;

      if (!name || !code) {
        alert("Please fill all fields");
        return;
      }

      await db.collection("allowedCodes").add({
        name,
        code,
        admin: isAdmin,
      });

      alert("Student added successfully!");
      loadStudents();
    };

    async function deleteStudent(id) {
      if (confirm("Are you sure you want to delete this student?")) {
        await db.collection("allowedCodes").doc(id).delete();
        loadStudents();
      }
    }

    window.deleteStudent = deleteStudent;
    loadStudents();
  </script>
</body>
</html>

