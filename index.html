<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <title>UniNotes / College Materials</title>
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=Cairo:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  
  <link rel="stylesheet" href="style.css">

  <style>
    /* Inline mobile overrides for specific layout needs */
    body, html { overflow-x: hidden; }
    
    .auth-wrap {
      display: flex;
      gap: 20px;
      flex-wrap: wrap; 
    }

    @media (max-width: 768px) {
      .container { padding: 10px; }
      header {
        flex-direction: row;
        justify-content: space-between;
        align-items: center;
        padding: 10px 0;
      }
      .app-layout { display: flex; flex-direction: column; }
      .sidebar { width: 100% !important; margin-bottom: 15px; }
      
      .sidebar .card:first-child {
        display: grid;
        grid-template-columns: repeat(3, 1fr); 
        gap: 5px;
        text-align: center;
      }

      .nav-item {
        font-size: 0.85rem;
        flex-direction: column;
        justify-content: center;
        padding: 10px 5px;
      }
      
      .subjects-grid, .materials-grid {
        display: grid;
        grid-template-columns: 1fr !important;
        gap: 10px;
      }
      
      .modal-content {
        width: 90% !important;
        margin: 10% auto;
        padding: 15px;
        max-height: 85vh;
        overflow-y: auto;
      }
      
      input, select, textarea, button { width: 100%; box-sizing: border-box; }
      .auth-box { width: 100%; }
    }
  </style>
</head>
<body>

  <div class="container">
    <header>
      <div class="logo"><i class="fa-solid fa-graduation-cap"></i> UniNotes</div>
      
      <div class="nav" style="display:flex; gap:10px; align-items:center;">
        <div id="userName" style="font-weight: bold; color: var(--accent);">Ø²Ø§Ø¦Ø±</div>
        
        <button onclick="cycleTheme()" class="btn" title="ØªØºÙŠÙŠØ± Ø§Ù„Ù…Ø¸Ù‡Ø±">
            <i id="themeIcon" class="fa-solid fa-palette"></i>
        </button>

        <button id="adminBtn" class="btn hidden" onclick="showPage('admin')">Admin</button>
        
        <button onclick="handleLogout()" class="btn"><i class="fa-solid fa-right-from-bracket"></i></button>
    </div>
    </header>

    <div id="loginPage">
      <div class="auth-wrap">
        <div class="auth-box card" style="flex: 1; min-width: 300px;">
          <div class="tab-container">
            <div class="tab-btn active" onclick="switchTab('login')">ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„</div>
            <div class="tab-btn" onclick="switchTab('register')">Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯</div>
          </div>

          <form id="loginForm">
            <input id="loginEmail" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¬Ø§Ù…Ø¹ÙŠ Ø£Ùˆ Ø§Ù„ÙƒÙˆØ¯" style="margin-bottom: 10px;" />
            <input id="loginPassword" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" type="password" style="margin-bottom: 10px;" />
            <div id="loginError" style="color:#ff7b7b; min-height:18px; font-size: 0.9em;"></div>
            <button type="button" class="btn primary" style="width:100%" onclick="handleLogin()">Ø¯Ø®ÙˆÙ„</button>
          </form>

          <form id="registerForm" class="hidden">
            <input id="registerName" placeholder="Ø§Ù„Ø§Ø³Ù… Ø«Ù„Ø§Ø«ÙŠ" style="margin-bottom: 10px;" />
            <input id="registerEmail" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ" style="margin-bottom: 10px;" />
            <input id="registerPassword" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" type="password" style="margin-bottom: 10px;" />
            <div id="registerError" style="color:#ff7b7b; min-height:18px; font-size: 0.9em;"></div>
            <button type="button" class="btn primary" style="width:100%" onclick="handleRegister()">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨</button>
          </form>
        </div>

        <div style="flex:1; min-width: 300px;">
          <div class="card">
            <h3><i class="fa-solid fa-bolt"></i> Ù…Ø§ Ù‡Ùˆ UniNotesØŸ</h3>
            <p style="color:var(--text-secondary); margin-top: 10px;">
              Ù…Ù†ØµØ© Ù…Ø±ÙƒØ²ÙŠØ© Ù„Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ù…Ù„Ø®ØµØ§ØªØŒ Ø§Ù„ØªÙƒØ§Ù„ÙŠÙØŒ ÙˆØ§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ø®Ø§ØµØ© Ø¨Ø§Ù„ÙƒÙ„ÙŠØ©. Ù…ÙƒØ§Ù† ÙˆØ§Ø­Ø¯ ÙŠØ¬Ù…Ø¹ ÙƒÙ„ Ù…Ø§ ÙŠØ­ØªØ§Ø¬Ù‡ Ø§Ù„Ø·Ø§Ù„Ø¨.
            </p>
          </div>
        </div>
      </div>
    </div>

    <div id="mainApp" class="hidden">
      <div class="app-layout">
        
       <aside class="sidebar">
          <div class="card">
            <div class="nav-item" onclick="showPage('home')"><i class="fa-solid fa-house"></i> Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</div>
            <div class="nav-item" onclick="showPage('subjects')"><i class="fa-solid fa-book-open-reader"></i> Ø§Ù„Ù…ÙˆØ§Ø¯</div>
            <div class="nav-item" onclick="showPage('announcements')"><i class="fa-solid fa-bullhorn"></i> Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª</div>
            
            <div class="nav-item" onclick="window.open('https://wa.me/201120201667', '_blank')">
                <i class="fa-brands fa-whatsapp" style="color: #25D366;"></i> ØªÙˆØ§ØµÙ„
            </div>
          </div>

          <div class="card">
            <h4 style="margin-bottom: 10px;">Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…Ù†ØµØ©</h4>
            <div id="statsGrid" class="stats-grid"></div>
          </div>
          
          <div class="card hidden" id="favoritesSection">...</div>
        </aside>

        <main style="flex: 1;">
          
          <div id="homePage" class="card">
            <h2 style="margin-bottom: 15px;">ğŸ“¢ Ø¢Ø®Ø± Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª</h2>
            <div id="recentAnnouncements"></div>
          </div>
          
          <div id="subjectsPage" class="hidden">
            <div class="card">
                <h2>ğŸ“š Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©</h2>
                <p style="color: var(--text-secondary);">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø§Ø¯Ø© Ù„ØªØµÙØ­ Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ø®Ø§ØµØ© Ø¨Ù‡Ø§</p>
            </div>
            <div id="subjectsGrid" class="subjects-grid"></div>
          </div>

          <div id="materialsPage" class="hidden">
            <div class="card">
              <div class="toolbar">
                <h3 id="materialSubjectTitle">Ø§Ù„Ù…Ø§Ø¯Ø©</h3>
                <div class="search-container">
                  <input id="searchBox" placeholder="ğŸ” Ø§Ø¨Ø­Ø« ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø§Ø¯Ø©..." style="width: 100%; margin-bottom: 10px;" />
                  <div class="filters" style="display: flex; gap: 5px; flex-wrap: wrap;">
                    <button class="filter-btn active" onclick="filterByType('all')">Ø§Ù„ÙƒÙ„</button>
                    <button class="filter-btn" onclick="filterByType('summary')">Ù…Ù„Ø®ØµØ§Øª</button>
                    <button class="filter-btn" onclick="filterByType('assignment')">ØªÙƒØ§Ù„ÙŠÙ</button>
                  </div>
                </div>
              </div>
            </div>
            <div id="materialsList" class="materials-grid"></div>
          </div>

          <div id="announcementsPage" class="card hidden">
            <h3>ÙƒÙ„ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª</h3>
            <div id="announcementsList" style="margin-top: 15px;"></div>
          </div>

          <div id="adminPage" class="card hidden">
            <h3>ğŸ›¡ï¸ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… (Ø§Ù„Ù…Ø´Ø±Ù)</h3>
            
            <h4 style="margin-top: 20px; color: #fb923c;">ğŸ“¢ Ù†Ø´Ø± Ø¥Ø¹Ù„Ø§Ù† Ø¬Ø¯ÙŠØ¯</h4>
            <div style="display: grid; gap: 10px; margin-bottom: 30px; padding-bottom: 20px; border-bottom: 1px solid var(--border);">
                <input id="announcementTitle" placeholder="Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†" style="padding: 10px;" />
                <textarea id="announcementContent" placeholder="Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†" rows="4" style="padding: 10px;"></textarea>
                <button class="btn primary" onclick="postAnnouncement()">Ù†Ø´Ø± Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†</button>
            </div>

            <h4>ğŸ“‚ Ø±ÙØ¹ Ù…Ø§Ø¯Ø© Ø¬Ø¯ÙŠØ¯Ø©</h4>
            <p style="color: var(--text-secondary); margin-bottom: 10px;">
                ÙŠÙ…ÙƒÙ†Ùƒ Ù‡Ù†Ø§ Ø±ÙØ¹ Ù…Ù„ÙØ§Øª Ø¬Ø¯ÙŠØ¯Ø© (Ù…Ù„Ø®ØµØ§Øª Ø£Ùˆ ØªÙƒØ§Ù„ÙŠÙ) Ù„ØªØ¸Ù‡Ø± Ù„Ù„Ø·Ù„Ø§Ø¨ Ù…Ø¨Ø§Ø´Ø±Ø©.
            </p>
            
            <div style="display: grid; gap: 10px; margin-top: 10px;">
                <select id="adminSubject" style="padding: 10px;">
                    <option value="Subject N1">Subject N1</option>
                    <option value="Subject N2">Subject N2</option>
                    <option value="Subject N3">Subject N3</option>
                    <option value="Subject N4">Subject N4</option>
                    <option value="Subject N5">Subject N5</option>
                </select>
                
                <select id="adminType" style="padding: 10px;">
                    <option value="summary">Ù…Ù„Ø®Øµ (Summary)</option>
                    <option value="assignment">ØªÙƒÙ„ÙŠÙ (Assignment)</option>
                </select>
                
                <input id="adminTitle" placeholder="Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ù„Ù" style="padding: 10px;" />
                <textarea id="adminDesc" placeholder="ÙˆØµÙ Ø§Ù„Ù…Ù„Ù (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)" style="padding: 10px;"></textarea>
                
                <div style="border: 2px dashed var(--border); padding: 20px; text-align: center; border-radius: 8px;">
                    <input id="adminFiles" type="file" multiple onchange="handleFileSelect(event)" style="display: none;" />
                    <button onclick="document.getElementById('adminFiles').click()" class="btn">Ø§Ø®ØªØ± Ø§Ù„Ù…Ù„ÙØ§Øª</button>
                    <div id="fileList" style="margin-top: 10px;"></div>
                </div>

                <div id="uploadProgress" style="display:none; margin-top:8px">
                  <div style="background:rgba(255,255,255,0.1); height:6px; border-radius:6px; overflow:hidden">
                    <div id="progressBar" style="width:0%; height:100%; background:var(--accent); transition: width 0.3s;"></div>
                  </div>
                  <div id="progressText" style="font-size:0.85em; color:var(--text-secondary); margin-top:6px; text-align: center;"></div>
                </div>

                <button class="btn primary" onclick="uploadMaterial()">ğŸš€ Ù†Ø´Ø± Ø§Ù„Ù…Ù„ÙØ§Øª</button>
            </div>
          </div>

        </main>
      </div>
    </div>
  </div>

  <div id="materialModal" class="modal-overlay">
    <div class="modal-content">
        <div style="display:flex; justify-content:space-between; align-items:start; margin-bottom:15px">
          <h3 id="modalTitle" style="font-size: 1.3rem;"></h3>
          <span id="modalTypeBadge" class="material-type-badge"></span>
        </div>
        
        <p id="modalDesc" style="color: var(--text-secondary); margin-bottom: 15px; background: rgba(0,0,0,0.2); padding: 10px; border-radius: 8px;"></p>
        
        <div style="font-size: 0.9em; color: var(--text-secondary); display: flex; gap: 15px; margin-bottom: 20px; flex-wrap: wrap;">
            <span><i class="fa-regular fa-user"></i> <span id="modalUploader"></span></span>
            <span><i class="fa-regular fa-calendar"></i> <span id="modalDate"></span></span>
        </div>

        <h4 style="margin-bottom: 10px;">Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ø±ÙÙ‚Ø©:</h4>
        <div id="modalFiles" style="display: flex; flex-direction: column; gap: 8px;"></div>
        
        <div style="text-align:center; margin-top:20px">
            <button class="btn" style="width: 100%;" onclick="closeModal()">Ø¥ØºÙ„Ø§Ù‚</button>
        </div>
    </div>
  </div>

  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>

  <script src="script.js"></script> 

  </body>
</html>